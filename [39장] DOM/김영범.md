# [39장] DOM

## DOM 이란?

HTML 문서의 계층적 구조와 정보를 표현, 제어할 수 있는 API 를 말한다.
이 API 들은 프로퍼티와 메서드를 제공하며 자료구조 중 트리의 구조 형태로 이뤄져 있다.

## 39.1 노드

### 📝 HTML 요소와 노드 객체

HTML 요소는 `<body></body>`, `<div>></div>` 와 같은 태그들로 표현하는 것들을 말한다.

이런 HTML 요소들은 렌더링 엔진에 의해 DOM을 구성하는 요소 노드 객체로 변환 된다.

![HTML 요소의 구조](./img/HTML_elem.png)

이렇게 HTML 요소들을 객체화한 다음, 아래의 트리 구조처럼 구성한다.

![트리 구조](./img/DOM_tree.png)

### 📝 노드 객체의 타입

![DOM](./img/DOM.png)

위 처럼 DOM 객체가 만들어졌다고 해보자.

HTML 문서의 공백 문자 또한 `공백 텍스트 노드`로 표현되지만, 여기서는 생략했다.

크게 4가지만 보자.

- 문서 노드(document node)

최상위에 존재하는 루트 노드로서 document 객체를 가리킨다.
브라우저가 렌더링한 HTML 문서 전체를 포함하는 객체로, 전역 객체 window 의 document 프로퍼티가 이것이다.

- 요소 노드(element node)

`<a></a>`, `<div></div>` 와 같은 HTML 태그로 표현하는 요소들을 생각하면 된다.

- 어트리뷰트 노드(attribute node)

HTML 요소들의 어트리뷰트를 가리키는 객체다.
별도의 부모 노드를 갖지 않고, 어트리뷰트 노드와 요소 노드 끼리 연결되어 있다.
어트리뷰트 노드를 참조, 변경하려면 요소 노드에 먼저 접근해야 가능하다!

- 텍스트 노드(text node)

HTML 요소 내부에 작성한 텍스트를 가리키는 객체다.
`<div>텍스트 노드에 포함되는 부분</div>`, 이 텍스트 노드는 `<div>` 요소 노드의 자식 노드가 된다.

DOM 에서 leaf node 가 이 텍스트 노드다!

이외에도 총 12 개의 노드 타입이 존재하지만, 나중에 살펴보자.

### 📝 노드 객체의 상속 구조

DOM 에 대해서 간단히 알아보았다.
트리 구조를 통해 HTML 문서의 정보를 표현하고, 문서에 접근 / 제어 할 수 있는 API 를 제공하는 역할을 한다.

이번엔 DOM 을 구성하는 노드 하나가 어떻게 이루어져 있는지 살펴보자.

노드 객체는 ECMAScript 표준 빌트인 객체가 아니고, 브라우저 환경에서 제공하는 호스트 객체다.
하지만, 이들도 프로토타입에 의한 상속 구조를 가지고 있다.

![노드 객체](./img/DOM_node.png)

이 구조는 모든 노드 객체가 상속 받는 구조다.
객체이기 때문에, Object 인터페이스를 상속 받은 뒤 차례로 하위 프로토타입을 상속 받는다.

또한, 각 노드의 유형(요소, 어트리뷰트, 텍스트 등)에 따라 추가로 인터페이스를 상속 받는다.

input 요소의 프로토타입 체인을 한 번 살펴보면서 눈으로 익혀보자.

![input 요소 노드 객체 프로토타입 체인](./img/input_node.png)

input 요소 하나에 이렇게 많은 객체의 상속이 이루어져있다.

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <input type="text" />
    <script>
      const $input = document.querySelector("input");

      console.log(
        Object.getPrototypeOf($input) === HTMLInputElement.prototype, // true
        Object.getPrototypeOf(HTMLInputElement.prototype) ===
          HTMLElement.prototype, // true
        Object.getPrototypeOf(HTMLElement.prototype) === Element.prototype, // ture
        Object.getPrototypeOf(Element.prototype) === Node.prototype, // true
        Object.getPrototypeOf(EventTarget.prototype) === Object.prototype // true
      );
    </script>
  </body>
</html>
```

위 예시는, 제일 먼저 `input` 요소의 프로토타입을 확인하면서 상위로 올라가고 전체 프로토타입 체인을 확인해보는 예시다.

각 프로토타입 객체가 어떤 기능을 하는지 간단히 알아보자.

| input 요소 노드 객체의 특성                                              | 프로토타입을 제공하는 객체 |
| ------------------------------------------------------------------------ | -------------------------- |
| 객체                                                                     | Object                     |
| 이벤트를 발생시키는 객체                                                 | EventTarget                |
| 트리 자료구조의 노드 객체                                                | Node                       |
| 브라우저가 렌더링할 수 있는 웹 문서 요소(HTML, XML, SVG)를 표현하는 객체 | Element                    |
| 웹 문서 요소 중에서 HTML 요소를 표현하는 객체                            | HTMLElement                |
| HTML 요소 중에서 input 요소를 표현하는 객체                              | HTMLInputElement           |

지금까지 input 요소를 살펴보면서 HTML 문서를 구성하는 요소가 어떻게 구성되어있는지 살펴보았다.

이렇게 다양한 객체들이 존재하기에 우리는 HTML 웹 문서를 동적으로 조작할 수 있게 되는 것이다!
