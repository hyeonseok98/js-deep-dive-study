# [44ì¥] REST API
- REST(Representational State Transfer): íš¨ìœ¨ì , ì•ˆì •ì ì´ë©° í™•ì¥ê°€ëŠ¥í•œ ë¶„ì‚°ì‹œìŠ¤í…œì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ” ì†Œí”„íŠ¸ì›¨ì–´ ì•„í‚¤í…ì²˜ ë””ìì¸ ì œì•½ì˜ ëª¨ìŒ

## ğŸ“Œ 44.1 REST APIì˜ êµ¬ì„±
- REST APIëŠ” ìì›(resource), í–‰ìœ„(verb), í‘œí˜„(representations)ì˜ 3ê°€ì§€ë¡œ êµ¬ì„±
- RESTëŠ” ìì²´ í‘œí˜„ êµ¬ì¡°ë¡œ êµ¬ì„±ë˜ì–´ REST APIë§Œìœ¼ë¡œ HTTP ìš”ì²­ì˜ ë‚´ìš©ì„ ì´í•´í•  ìˆ˜ ìˆìŒ
  
| êµ¬ì„± ìš”ì†Œ               | ë‚´ìš©                | í‘œí˜„ ë°©ë²•        |
|-------------------------|---------------------|------------------|
| ìì›(resource)          | ìì›                | URI(ì—”ë“œí¬ì¸íŠ¸)  |
| í–‰ìœ„(verb)              | ìì›ì— ëŒ€í•œ í–‰ìœ„    | HTTP ìš”ì²­ ë©”ì„œë“œ |
| í‘œí˜„(representations)   | ìì›ì— ëŒ€í•œ í–‰ìœ„ì˜ êµ¬ì²´ì  ë‚´ìš© | í˜ì´ë¡œë“œ         |


<br />

## ğŸ“Œ 44.2 REST API ì„¤ê³„ ì›ì¹™
- `URI`ëŠ” `ë¦¬ì†ŒìŠ¤ë¥¼ í‘œí˜„í•˜ëŠ”ë° ì§‘ì¤‘`í•˜ê³ , `í–‰ìœ„`ì— ëŒ€í•œ ì •ì˜ëŠ” `HTTP ìš”ì²­ ë©”ì„œë“œë¥¼ í†µí•´ í•˜ëŠ” ê²ƒ`

### 1. URIëŠ” ë¦¬ì†ŒìŠ¤ë¥¼ í‘œí˜„í•´ì•¼ í•œë‹¤.
- ë¦¬ì†ŒìŠ¤ë¥¼ ì‹ë³„í•  ìˆ˜ ìˆëŠ” ì´ë¦„ì€ ë™ì‚¬ë³´ë‹¤ ëª…ì‚¬ë¥¼ ì‚¬ìš©
```jsx
// bad...
GET /getTodo/1
GET /todos/show/1

// good!!
GET /todos/1
```

### 2. ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ í–‰ìœ„ëŠ” HTTP ìš”ì²­ ë©”ì„œë“œë¡œ í‘œí˜„í•œë‹¤.
- HTTP ìš”ì²­ ë©”ì„œë“œëŠ” í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì—ê²Œ ìš”ì²­ì˜ ì¢…ë¥˜ì™€ ëª©ì ì„ ì•Œë¦¬ëŠ” ë°©ë²•
- ì£¼ë¡œ ì•„ë˜ì™€ ê°™ì€ 5ê°€ì§€ ìš”ì²­ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ CRUD êµ¬ì„±í•¨

| HTTP ìš”ì²­ ë©”ì„œë“œ | ì¢…ë¥˜              | ëª©ì                 | í˜ì´ë¡œë“œ |
|-----------------|------------------|---------------------|---------|
| GET             | index/retrieve   | ëª¨ë“ /íŠ¹ì • ë¦¬ì†ŒìŠ¤ ì·¨ë“ | X       |
| POST            | create           | ë¦¬ì†ŒìŠ¤ ìƒì„±          | O       |
| PUT             | replace          | ë¦¬ì†ŒìŠ¤ì˜ ì „ì²´ êµì²´   | O       |
| PATCH           | modify           | ë¦¬ì†ŒìŠ¤ì˜ ì¼ë¶€ ìˆ˜ì •   | O       |
| DELETE          | delete           | ëª¨ë“ /íŠ¹ì • ë¦¬ì†ŒìŠ¤ ì‚­ì œ | X       |

- ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ í–‰ìœ„ëŠ” URIì— í‘œí˜„í•˜ì§€ ì•ŠìŒ
```jsx
// bad...
GET /todos/delete/1

// good!!
DELETE /todos/1
```


<br />

## ğŸ“Œ 44.3 JSON Serverë¥¼ ì´ìš©í•œ REST API ì‹¤ìŠµ
- JSON Server: json íŒŒì¼ì„ ì‚¬ìš©í•˜ì—¬ ê°€ìƒ REST API ì„œë²„ë¥¼ êµ¬ì¶•í•  ìˆ˜ ìˆëŠ” tool

### ğŸ€ 44.3.1 JSON Server ì„¤ì¹˜
- npm ì‚¬ì´íŠ¸ ì°¸ê³ : https://www.npmjs.com/package/json-server

<br />

### ğŸ€ 44.3.2  db.json íŒŒì¼ ìƒì„±
```jsx
{
  "todos": [
    {
      "id": 1,
      "content": "HTML",
      "completed": true
    },
    {
      "id": 2,
      "content": "CSS",
      "completed": false
    },
    {
      "id": 3,
      "content": "Javascript",
      "completed": true
    }
  ]
}
```

<br />

### ğŸ€ 44.3. JSON Servert ì‹¤í–‰
- JSON Serverê°€ DB ì—­í• ì„ í•˜ëŠ” db.json íŒŒì¼ì˜ ë³€ê²½ì„ ê°ì§€í•˜ê²Œ í•˜ë ¤ë©´ watch ì˜µì…˜ ì¶”ê°€
```jsx
$ json-server --watch db.json
```
- ì•„ë˜ì™€ ê°™ì´ package.json íŒŒì¼ì„ ìˆ˜ì •í•˜ê³  `npm start`ë¥¼ ì‹¤í–‰í•˜ë©´ ê°„í¸í•˜ê²Œ ì„œë²„ë¥¼ ê°€ë™ì‹œí‚¬ ìˆ˜ ìˆë‹¤.
```jsx
{
  "name": "json-server-exam",
  "version": "1.0.0",
  "scripts": {
    "start": "json-server --watch db.json"
  },
  "devDependencies": {
    "json-server": "^0.16.1"
  }
}
```

<br />

### ğŸ€ 44.3.4 GET ìš”ì²­
- todos ë¦¬ì†ŒìŠ¤ì—ì„œ ëª¨ë“  todoë¥¼ ê°€ì ¸ì˜¬ ë•Œ
```jsx
<!DOCTYPE html>
<html>
<body>
  <pre></pre>
  <script>
    // XMLHttpRequest ê°ì²´ ìƒì„±
    const xhr = new XMLHttpRequest();

    // HTTP ìš”ì²­ ì´ˆê¸°í™”
    // todos ë¦¬ì†ŒìŠ¤ì—ì„œ ëª¨ë“  todoë¥¼ ì·¨ë“(index) => /todos ì—”ë“œí¬ì¸íŠ¸ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•¨
    xhr.open('GET', '/todos');

    // ì´ˆê¸°í™” ëœ HTTP ìš”ì²­ì„ ì„œë²„ì— ì „ì†¡
    xhr.send();

    // load ì´ë²¤íŠ¸ëŠ” ìš”ì²­ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œëœ ê²½ìš° ë°œìƒí•œë‹¤.
    xhr.onload = () => {
      // status í”„ë¡œí¼í‹° ê°’ì´ 200ì´ë©´ ì •ìƒì ìœ¼ë¡œ ì‘ë‹µëœ ìƒíƒœë‹¤.
      if (xhr.status === 200) {
        document.querySelector('pre').textContent = xhr.response;
      } else {
        console.error('Error', xhr.status, xhr.statusText);
      }
    };
  </script>
</body>
</html>
```

```jsx
// React ì½”ë“œ
import React, { useEffect, useState } from 'react';

const TodoList = () => {
  const [todos, setTodos] = useState('');
  const [error, setError] = useState(null);

  useEffect(() => {
    // XMLHttpRequest ê°ì²´ ìƒì„±
    const xhr = new XMLHttpRequest();

    // HTTP ìš”ì²­ ì´ˆê¸°í™”
    xhr.open('GET', '/todos'); // íŠ¹ì • ìš”ì†Œë¥¼ ê°€ì§€ê³ ì˜¤ê³  ì‹¶ìœ¼ë©´ '/todos/1' ì´ëŸ°ì‹ìœ¼ë¡œ ì‚¬ìš©

    // load ì´ë²¤íŠ¸ëŠ” ìš”ì²­ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œëœ ê²½ìš° ì‹¤í–‰
    xhr.onload = () => {
      if (xhr.status === 200) {
        setTodos(xhr.response);
      } else {
        setError(`Error ${xhr.status}: ${xhr.statusText}`);
      }
    };

    // HTTP ìš”ì²­ ì „ì†¡
    xhr.send();
  }, []);

  return (
    <div>
      {error && <p>{error}</p>}
      <pre>{todos}</pre>
    </div>
  );
};

export default TodoList;
```

<br />

### ğŸ€ 44.3.5 POST ìš”ì²­
- todos ë¦¬ì†ŒìŠ¤ì— ìƒˆë¡œìš´ todo ìƒì„±
```jsx
<!DOCTYPE html>
<html>
<body>
  <pre></pre>
  <script>
    const xhr = new XMLHttpRequest();

    xhr.open('POST', '/todos');

    // ìš”ì²­ ëª¸ì²´ì— ë‹´ì•„ ì„œë²„ë¡œ ì „ì†¡í•  í˜ì´ë¡œë“œì˜ MIME íƒ€ì…ì„ ì§€ì •
    xhr.setRequestHeader('content-type', 'application/json');

    // HTTP ìš”ì²­ ì „ì†¡
    // ìƒˆë¡œìš´ todoë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ í˜ì´ë¡œë“œë¥¼ ì„œë²„ì— ì „ì†¡í•´ì•¼ í•œë‹¤.
    xhr.send(JSON.stringify({ id: 4, content: 'Angular', completed: false }));

    xhr.onload = () => {
      // status í”„ë¡œí¼í‹° ê°’ì´ 200(OK) ë˜ëŠ” 201(Created)ì´ë©´ ì •ìƒì ìœ¼ë¡œ ì‘ë‹µëœ ìƒíƒœ
      if (xhr.status === 200 || xhr.status === 201) {
        document.querySelector('pre').textContent = xhr.response;
      } else {
        console.error('Error', xhr.status, xhr.statusText);
      }
    };
  </script>
</body>
</html>
```
```jsx
// React ì½”ë“œ
import React, { useState } from 'react';

const CreateTodo = () => {
  const [response, setResponse] = useState('');
  const [error, setError] = useState(null);

  const createTodo = async () => {
    try {
      const res = await fetch('/todos', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ id: 4, content: 'Angular', completed: false }),
      });

      if (res.ok) {
        const data = await res.json();
        setResponse(JSON.stringify(data, null, 2)); //(value, í•„í„°ë§, ë“¤ì—¬ì“°ê¸°)
      } else {
        throw new Error(`Error ${res.status}: ${res.statusText}`);
      }
    } catch (err) {
      setError(err.message);
    }
  };

  return (
    <div>
      <button onClick={createTodo}>Create Todo</button>
      {error && <p>{error}</p>}
      <pre>{response}</pre>
    </div>
  );
};

export default CreateTodo;
```
- setResponse(JSON.stringify(data)) ì‚¬ìš©ì‹œ
```jsx
{"id":4,"content":"Angular","completed":false}

```
- setResponse(JSON.stringify(data, null, 2)) ì‚¬ìš©ì‹œ
```jsx
{
  "id": 4,
  "content": "Angular",
  "completed": false
}
```

<br />

### ğŸ€ 44.3.6 PUT ìš”ì²­
- PUT: íŠ¹ì • ë¦¬ì†ŒìŠ¤ ì „ì²´ë¥¼ êµì²´í•  ë•Œ ì‚¬ìš©
- ì•„ë˜ ì˜ˆì‹œëŠ” íŠ¹ì • idë¥¼ ì œì™¸í•œ ë¦¬ì†ŒìŠ¤ ì „ì²´ë¥¼ êµì²´í•¨
```jsx
<!DOCTYPE html>
<html>
<body>
  <pre></pre>
  <script>
    const xhr = new XMLHttpRequest();

    // HTTP ìš”ì²­ ì´ˆê¸°í™”
    // todos ë¦¬ì†ŒìŠ¤ì—ì„œ idë¡œ todoë¥¼ íŠ¹ì •í•˜ì—¬ idë¥¼ ì œì™¸í•œ ë¦¬ì†ŒìŠ¤ ì „ì²´ë¥¼ êµì²´
    xhr.open('PUT', '/todos/4');

    // ìš”ì²­ ëª¸ì²´ì— ë‹´ì•„ ì„œë²„ë¡œ ì „ì†¡í•  í˜ì´ë¡œë“œì˜ MIME íƒ€ì…ì„ ì§€ì •
    xhr.setRequestHeader('content-type', 'application/json');

    // HTTP ìš”ì²­ ì „ì†¡
    // ë¦¬ì†ŒìŠ¤ ì „ì²´ë¥¼ êµì²´í•˜ê¸° ìœ„í•´ í˜ì´ë¡œë“œë¥¼ ì„œë²„ì— ì „ì†¡í•´ì•¼ í•œë‹¤.
    xhr.send(JSON.stringify({ id: 4, content: 'React', completed: true }));

    xhr.onload = () => {
      if (xhr.status === 200) {
        document.querySelector('pre').textContent = xhr.response;
      } else {
        console.error('Error', xhr.status, xhr.statusText);
      }
    };
  </script>
</body>
</html>
```
<br />

### ğŸ€ 44.3.7 PATCH ìš”ì²­
- íŠ¹ì • ë¦¬ì†ŒìŠ¤ì˜ ì¼ë¶€ë¥¼ ìˆ˜ì •í•  ë•Œ ì‚¬ìš©
- ì•„ë˜ ì˜ˆì œì—ì„œëŠ” todos ë¦¬ì†ŒìŠ¤ì˜ idë¡œ  todoë¥¼ íŠ¹ì •í•˜ì—¬ completedë§Œ ìˆ˜ì •í•¨
- PATCH ìš”ì²­ì‹œ setRequestHeader ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ìš”ì²­ ëª¸ì²´ì— ë‹´ì•„ ì„œë²„ë¡œ ì „ì†¡í•  í˜ì´ë¡œë“œì˜ MIME íƒ€ì…ì„ ì§€ì •í•´ì•¼ í•¨.
```jsx
<!DOCTYPE html>
<html>
<body>
  <pre></pre>
  <script>
    const xhr = new XMLHttpRequest();

    // HTTP ìš”ì²­ ì´ˆê¸°í™”
    // todos ë¦¬ì†ŒìŠ¤ì˜ idë¡œ todoë¥¼ íŠ¹ì •í•˜ì—¬ completedë§Œ ìˆ˜ì •
    xhr.open('PATCH', '/todos/4');

    // ìš”ì²­ ëª¸ì²´ì— ë‹´ì•„ ì„œë²„ë¡œ ì „ì†¡í•  í˜ì´ë¡œë“œì˜ MIME íƒ€ì…ì„ ì§€ì •
    xhr.setRequestHeader('content-type', 'application/json');

    // HTTP ìš”ì²­ ì „ì†¡
    // ë¦¬ì†ŒìŠ¤ë¥¼ ìˆ˜ì •í•˜ê¸° ìœ„í•´ í˜ì´ë¡œë“œë¥¼ ì„œë²„ì— ì „ì†¡í•´ì•¼ í•œë‹¤.
    xhr.send(JSON.stringify({ completed: false }));

    xhr.onload = () => {
      if (xhr.status === 200) {
        document.querySelector('pre').textContent = xhr.response;
      } else {
        console.error('Error', xhr.status, xhr.statusText);
      }
    };
  </script>
</body>
</html>
```


<br />

### ğŸ€ 44.3.8 DELETE ìš”ì²­
- todo ë¦¬ì†ŒìŠ¤ì—ì„œ idë¥¼ ì‚¬ìš©í•˜ì—¬ todoë¥¼ ì‚­ì œí•œë‹¤.
```jsx
<!DOCTYPE html>
<html>
<body>
  <pre></pre>
  <script>
    const xhr = new XMLHttpRequest();

    // HTTP ìš”ì²­ ì´ˆê¸°í™”
    // todos ë¦¬ì†ŒìŠ¤ì—ì„œ idë¥¼ ì‚¬ìš©í•˜ì—¬ todoë¥¼ ì‚­ì œí•œë‹¤.
    xhr.open('DELETE', '/todos/4');

    xhr.send();

    xhr.onload = () => {
      if (xhr.status === 200) {
        document.querySelector('pre').textContent = xhr.response;
      } else {
        console.error('Error', xhr.status, xhr.statusText);
      }
    };
  </script>
</body>
</html>
```
